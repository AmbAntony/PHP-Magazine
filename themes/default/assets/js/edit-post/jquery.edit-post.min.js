// +------------------------------------------------------------------------+
// | @author Oscar GarcÃ©s (SoyVillareal)
// | @author_url 1: https://soyvillareal.com
// | @author_url 2: https://github.com/soyvillareal
// | @author_email: hi@soyvillareal.com   
// +------------------------------------------------------------------------+
// | PHP Magazine - The best digital magazine for newspapers or bloggers
// | Licensed under the MIT License. Copyright (c) 2022 PHP Magazine.
// +------------------------------------------------------------------------+
(function(){var t,e,n,a,i,r,o,s,d,l,p,c,u=function(t,e){return t.attr("disabled",e)},f=function(t,e,n){t?t.removeClass("border-red boxshadow-red"):n.removeClass("background-red"),e&&e.text("")},h=function(t,e,n,a,i=!0){t?t.addClass("border-red boxshadow-red"):i&&a.addClass("background-red"),e&&e.text(n),a&&m(a)},m=function(t){u(t,!1).removeClass("spinner-is-loading")},v=function(t,e){var n=t.parents(".entry-carousel"),a=n.length>0?n:t.parents(".content-field");if(a.find(".thumbnail_file").length>0)a.find(".content-placeholder").addClass("hidden"),a.find(".content-image").removeClass("hidden"),a.find(".item_image").html('<img src="'+e+'" alt="'+paper_ep.word.preview+'"/>');else{var i=a.find(".content-carrusel"),r=i.find(".content-pbcarousel"),o=i.find(".content_captions"),s=a.find(".carousel_file"),d=s.attr("disabled")?"text":"file",l=t.hasClass("btn_gimage")?t.parents(".content-alert-popup"):a.parent(),p=l.find(".carousel_"+d),c=i.find(".content_files"),h=c.children().length+1;f(i,i.siblings(".text-error")),i.find("div[role=progressbar]").attr("aria-valuemax",h),i.find("div[role=group]").attr("aria-label","1 "+paper_ep.word.of+" "+h),i.find("div[role=progressbar]").attr("aria-valuenow",1),h>1&&i.find(".content-ecbuttons").removeClass("hidden"),a.find(".content-thumbnail").addClass("hidden"),u(p.clone(),!0).removeAttr("class").addClass("item_c"+d).prependTo(c),u(s,!1),p.val(""),i.removeClass("hidden").find(".entry_cimage").attr("src",e),r.children().removeClass("selected"),r.prepend('<button class="btn_crepos item-pbcarousel btn-noway padding-5 border-grely inhover-button animation-ease3s selected" data-image="'+e+'" type="button"><div class="item-pbcimage w-45px h-45" style="background-image: url('+e+');"></div></button>'),o.children().addClass("hidden"),o.prepend('<input class="item-input item_caption position-absolute z-index-1 no_validate w-100 h-30 color-wwhite padding-b5 padding-l10 padding-r10 text-center border-bottom border-grely border-focus-blue animation-ease3s sizing-box" type="text" placeholder="'+paper_ep.word.description+'">')}},g=function(){var t=$("#btn-post");$(".item_key:not(.no_validate, :disabled), .item_change:not(.no_validate, :disabled)").each(function(){if(""==$(this).val())return u(t,!0),!1;u(t,!1)})},b=!0;(function(){var t=$(".post_sources"),e=$(".btn_asource");t.first().children().length,t.last().children().length;e.click(function(){var e=$(this),n=e.attr("data-type"),a=t.first().children().length,i=t.last().children().length,r="post"==n?a+1:i+1;b&&(r<paper_ep.settings.number_of_fonts?(e.parent().next().find(".post_sources").append('<div class="display-flex direction-row align-center w-100 h-30 margin-t10"><span class="item_count font-bigly icon-z color-blackly margin-l5">'+r+'</span><div class="display-flex w-100"><input class="item-input item_key disable_before no_validate w-100 background-white color-black margin-r10 padding-r10 border-bottom border-black border-focus-blue animation-ease3s sizing-box" type="text" placeholder="'+paper_ep.word.name+'"><input class="item-input item_key disable_before no_validate w-100 background-white color-black padding-r10 border-bottom border-black border-focus-blue animation-ease3s sizing-box" type="text" placeholder="'+paper_ep.word.link+'"></div><button class="btn_sdelete area_validate display-flex btn-noway background-red margin-l5 border-rlow boxshadow-grey hover-button animation-ease3s" type="button" data-type="'+n+'"><svg class="icon-z color-wwhite" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M 10.091 16.688 L 10.091 9.813 C 10.091 9.721 10.061 9.646 10.001 9.588 C 9.942 9.529 9.866 9.5 9.773 9.5 L 9.136 9.5 C 9.044 9.5 8.967 9.529 8.908 9.588 C 8.848 9.646 8.818 9.721 8.818 9.813 L 8.818 16.688 C 8.818 16.779 8.848 16.854 8.908 16.912 C 8.967 16.971 9.044 17 9.136 17 L 9.773 17 C 9.866 17 9.942 16.971 10.001 16.912 C 10.061 16.854 10.091 16.779 10.091 16.688 Z M 12.636 16.688 L 12.636 9.813 C 12.636 9.721 12.607 9.646 12.547 9.588 C 12.487 9.529 12.411 9.5 12.318 9.5 L 11.682 9.5 C 11.589 9.5 11.513 9.529 11.453 9.588 C 11.393 9.646 11.364 9.721 11.364 9.813 L 11.364 16.688 C 11.364 16.779 11.393 16.854 11.453 16.912 C 11.513 16.971 11.589 17 11.682 17 L 12.318 17 C 12.411 17 12.487 16.971 12.547 16.912 C 12.607 16.854 12.636 16.779 12.636 16.688 Z M 15.182 16.688 L 15.182 9.813 C 15.182 9.721 15.152 9.646 15.092 9.588 C 15.033 9.529 14.956 9.5 14.864 9.5 L 14.227 9.5 C 14.134 9.5 14.058 9.529 13.999 9.588 C 13.939 9.646 13.909 9.721 13.909 9.813 L 13.909 16.688 C 13.909 16.779 13.939 16.854 13.999 16.912 C 14.058 16.971 14.134 17 14.227 17 L 14.864 17 C 14.956 17 15.033 16.971 15.092 16.912 C 15.152 16.854 15.182 16.779 15.182 16.688 Z M 9.773 7 L 14.227 7 L 13.75 5.857 C 13.704 5.799 13.647 5.763 13.581 5.75 L 10.429 5.75 C 10.363 5.763 10.306 5.799 10.26 5.857 Z M 19 7.313 L 19 7.938 C 19 8.029 18.97 8.104 18.911 8.162 C 18.851 8.221 18.775 8.25 18.682 8.25 L 17.727 8.25 L 17.727 17.508 C 17.727 18.048 17.572 18.515 17.26 18.909 C 16.948 19.303 16.574 19.5 16.136 19.5 L 7.864 19.5 C 7.426 19.5 7.052 19.31 6.74 18.929 C 6.429 18.548 6.273 18.087 6.273 17.547 L 6.273 8.25 L 5.318 8.25 C 5.225 8.25 5.149 8.221 5.089 8.162 C 5.03 8.104 5 8.029 5 7.938 L 5 7.313 C 5 7.221 5.03 7.146 5.089 7.088 C 5.149 7.029 5.225 7 5.318 7 L 8.391 7 L 9.087 5.369 C 9.186 5.128 9.365 4.923 9.624 4.754 C 9.882 4.585 10.144 4.5 10.409 4.5 L 13.591 4.5 C 13.856 4.5 14.118 4.585 14.376 4.754 C 14.635 4.923 14.814 5.128 14.913 5.369 L 15.609 7 L 18.682 7 C 18.775 7 18.851 7.029 18.911 7.088 C 18.97 7.146 19 7.221 19 7.313 Z"></path></svg></button></div>'),"post"==n?0:i++):u(e,!0))}),$(document).on("click",".btn_sdelete",function(t){var n=$(this),a=n.attr("data-type"),i="post"==a,r=n.parents(".post_sources"),o=r.children(),s=r.find(".btn_sdelete").index(n)+1;b&&(o[s].remove(),o.length==s+1?i?0:0:(i?2:2,r.find(".item_count").each(function(t,e){$(e).text(t+2),i?0:0})),u(e,!1))})})(),t=$("#content-tags"),e=$("#tags"),n=$("#new-tag"),a=$("#search-tags"),i=$("#tag-label"),r="margin-t5 margin-b5 margin-r5 padding-5",o=[],s=!1,d=function(t){t.removeClass("item-tag-active")},l=function(){0==$(".item_tag").length&&(!n.is(":focus")&&i.hasClass("active")&&i.removeClass("active"),n.parent().removeClass(r)),!n.is(":focus")&&i.removeClass("focus")},p=function(a){var i=$(".item_tag"),s=n.val(),l=a||s;return!(""===l||o.length>=paper_ep.settings.number_labels)&&(d(i),-1!=o.indexOf(l)?($(i[o.indexOf(l)]).addClass("item-tag-active"),!1):($('<li class="item_tag display-block position-relative background-blue '+r+' border-rlow border-all"><label class="tag_label color-black"></label><button class="tag_close btn-noway color-black hover-button animation-ease3s animate-tab-button"><svg class="icon-y vertical-sub" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="none" stroke="currentColor" stroke-width="2" d="M7,7 L17,17 M7,17 L17,7"/></svg></button></li>').insertBefore(t.find(".tag-new")).find(".tag_label").text(l),n.val("").parent().addClass(r),o.push(l),e.val(o.toString()),g(),c(),void f(t,t.next())))},c=function(){a.addClass("hidden").html("")},$(".tag_label").each(function(){o.push($(this).text())}),e.val(o.toString()),n.on("cut",c).keydown(function(t){var i=$(".item_tag"),r=i.last(),c=t.which||t.keyCode,u=n.val();if(!b)return!1;d(i),8==c&&""===u?s?(o.pop(),e.val(o.toString()),r.remove(),l(),g()):(s=!0,r.addClass("item-tag-active")):(s=!1,a.html("")),(188===c&&!1===t.shiftKey||13===c||9==c&&""!==u)&&(t.preventDefault(),p())}).keyup(function(){b&&(a.addClass("hidden"),""!=n.val()&&$.post(paper_ep.url.get_tags+"?token="+paper_ep.token,{search:n.val(),tags:JSON.stringify(o)},function(t){200==t.S&&t.TG===n.val()&&a.removeClass("hidden").html(t.HT)}))}).blur(function(t){var e=$(t.relatedTarget),i=n.val();if(!b)return!1;if(e.is(".btn_tag"))p($.trim(e.text()));else if(""!==i){if(-1!=o.indexOf(i))return d($(".item_tag")),l(),a.addClass("hidden"),!1;p(),l()}else l()}).focus(function(){b&&i.addClass("active focus")}),t.click(function(t){b&&$(t.target).is("UL")&&n.focus()}),$(document).click(function(t){if(!b)return!1;$(t.target).is("#content-tags, #content-tags *")&&""!=a.html()&&a.removeClass("hidden")}).on("click",".tag_close",function(){var t=$(this).parents(".item_tag");b&&(o.splice($(".item_tag").index(t),1),e.val(o.toString()),t.remove(),l(),g())}),$(document).on("keyup, input",".item_key",function(){var t=$(this),e=t.val();if(t.siblings(".btn_gvideo").length>0){var n=t.parent().next(),a=n.find(".youtube"),i=n.find(".dailymotion"),r=n.find(".vimeo"),o=n.find(".twitch");a.removeClass("active"),i.removeClass("active"),r.removeClass("active"),o.removeClass("active"),e.match(/^(?:http(?:s)?:\/\/)?(?:[a-z0-9.]+\.)?(?:youtu\.be|youtube\.com)\/(?:(?:watch)?\?(?:.*&)?v(?:i)?=|(?:embed|v|vi|user)\/)([^\?&\"'>]+)/)?a.addClass("active"):e.match(/^.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/)?i.addClass("active"):e.match(/^(?:http(?:s)?:\/\/)?(?:[a-z0-9.]+\.)?vimeo\.com\/([0-9]+)$/)?r.addClass("active"):e.match(/^(?:http(?:s)?:\/\/)?(?:[a-z0-9.]+\.)?twitch\.tv\/videos\/([0-9]+)$/)&&o.addClass("active")}""!=e?(t.addClass("active"),f(t,t.next(".text-error"))):t.removeClass("active"),g()}).on("change",".item_change",function(){var t=$(this),e=t.prop("type");if("file"==e){var n=t.prop("files");if(n&&n[0]){var a=new FileReader,i=t.parents(".content-thumbnail"),r=i.find(".item-placeholder"),o=i.find(".text-error");a&&a.readAsDataURL?(a.readAsDataURL(n[0]),$(a).on("load",function(){v(i,a.result),f(r,o)})):window.URL.createObjectURL&&(v(i,window.URL.createObjectURL(n[0])),f(r,o))}}g()}),function(){var t,e,n,a,i=$(".btn_aentry"),r=function(){$(".text_simditor").each(function(t=!1){var e=$(this).parents(".entry");if(0==e.find(".simditor").length){Simditor.locale=paper_ep.lang;var n=new Simditor({textarea:$(this),toolbar:["title","bold","italic","underline","strikethrough","fontScale","|","ol","ul","blockquote","|","link","indent","outdent","alignment"],pasteImage:!0,toolbarFloat:!1});n.on("valuechanged",function(){this.sync(),g(),f(this.el,this.el.next());var t=this.getValue().split("<p>");if(6===t.length){var n=$("<div>").html(t[5]);1==n.text().length&&d(e)}}),t&&n.focus(t)}})},o=function(t,e,n){e.addClass("hidden").next().addClass("hidden"),e.prev().html(n)},s=function(t="",e=!1){clearTimeout(l),$("#content-lnotify").css("rtl"==paper_ep.dir?"right":"left",e?20:"").find("p").text(t),l=setTimeout(function(){s()},5e3)},d=function(t){var e=$("#content-pposts .content_rbody");$(e[$(".entry[data-type=text]").index(t)]).length>0&&(p.pop(),e.last().remove(),0==p.length&&$("#btn-addrb").removeClass("hidden"))},l=0,p=paper_ep.recobo_ids;(function(){var t=$("#search-collaborators"),e=$("#btn-addcp"),n=$("#btn-cpsearch"),a=$("#content-susers"),i=$("#content-ausers"),r=paper_ep.collaborators_ids;e.click(function(){t.focus()}),t.keyup(function(){var e=t.val();e.length>0?u(n,!1):u(n,!0),$.post(paper_ep.url.ecu_search+"?token="+paper_ep.token,{keyword:e,user_ids:JSON.stringify(r)},function(t){200==t.S?a.html(t.HT):a.html(t.HT?t.HT:"")})}),$(document).on("click",".btn_putcollab",function(){var n=$(this);u(n,!0).addClass("spinner-is-loading"),$.post(paper_ep.url.push_user+"?token="+paper_ep.token,{push_id:n.attr("data-id"),user_ids:JSON.stringify(r)},function(a){200==a.S?(i.prepend(a.HT),r.push(a.ID),n.remove(),t.val(""),e.addClass("hidden"),m(n),i.sortable("refresh")):(s(a.E,!0),m(u(n,!1)))})}).on("click",".btn_dcollab",function(){var t=$(this).parents(".content-cpost");r.splice(r.indexOf(parseInt(t.attr("data-id"))),1),t.remove(),0==r.length&&e.removeClass("hidden")}),i.sortable({revert:!0,nested:!1,vertical:!1,forcePlaceholderSize:!0,placeholder:"user-placeholder w-100px h-100px background-grely margin-l10 border-rall border-grely boxshadow-grey"})})(),e=$("#alert-delete"),n=function(t){var e=$(".btn_popup[aria-expanded=true] ~ .content-alert-popup"),n=e.parents(".content-thumbnail"),a=(n.length>0?n:e.parents(".entry-carousel").find(".content-thumbnail")).find(".item-file"),i=e.find(".thumbnail_text");u(e.prev(),!1).attr("aria-expanded",!1),""!=a.val()||t&&u(a,!1),a.removeClass("hidden"),e.addClass("hidden").siblings(".item-placeholder").removeClass("active"),u(i,!0)},a=function(){e.addClass("hidden"),$("body").removeClass("overflow-hidden")},$("#btn-acancel").click(a),$("#btn-delete").click(function(){b&&(d(t),t.remove(),a(),g(),0==$(".entries .entry[data-type=video]").length&&$("#type").val("normal"))}),$(document).on("click",".btn_adelete",function(){b&&(t=$(this).parents(".entry"),e.removeClass("hidden"),$("body").addClass("overflow-hidden"))}).on("click",".btn_popup",function(){var t=$(this),e=t.siblings(".item-file"),a=e.length>0?e:t.parents(".entry-carousel").find(".content-thumbnail .item-file");b&&(n(),t.attr("aria-expanded",!0).blur().next().removeClass("hidden").next().addClass("active"),u(a,!0).addClass("hidden"),t.next().find(".text-error").text(""),u(u(t,!0).next().find("input"),!1).focus())}).on("click",".btn_gicancel",function(){$(this).parents(".content-placeholder"),n(!0)}).click(function(t){var i=$(t.target);!i.is(".btn_popup[aria-expanded=true], .btn_popup[aria-expanded=true] *, .btn_popup[aria-expanded=true] ~ .content-alert-popup, .btn_popup[aria-expanded=true] ~ .content-alert-popup *")&&n(!0),i.is(e)&&a()}).on("click",".btn_gimage",function(){var t=$(this),e=t.parents(".content-alert-popup"),a=e.find("input"),i=e.find(".text-error"),r=e.parents(".content-thumbnail");b&&(f(u(a,!0),i),u(t,!0).addClass("spinner-is-loading"),$.post(paper_ep.url.get_image+"?token="+paper_ep.token,{url:a.val()},function(o){200==o.S?(e.addClass("hidden"),n(),v(t,o.IM),m(t),g(),f(r.find(".item-placeholder"),r.find(".text-error"))):h(u(a,!1),i,o.E,t)}))}).on("click",".btn_cadd",function(){$(this).parents(".content-carrusel").next().find(".carousel_file").trigger("click")}),$(".btn_post").click(function(t){t.preventDefault();var e=$(this),n=[],a=$(".area_validate"),i=$(".post_sources"),r=$("#post-right"),o=r.find(".thumbnail_file")[0].files,d=$(".simditor-body"),l=$(".disable_before, .extra_shadow, .simditor"),p=l.parents(".content-field"),c=new FormData,v=function(t){var e=[],n=1;return $(i[t]).children().each(function(t,a){a=$(a);var i=a.find("input"),r=$(i[0]).val(),o=$(i[1]).val(),s=a.parent();e.push({name:r,source:o}),f(i,s.next()),0!=t&&""==r&&""==o?a.remove():(a.find(".item_count").text(n),n++)}),e},g=function(t){var e=[];return t.each(function(){e.push(parseInt($(this).attr("data-id")))}),e};if(!b)return!1;c.append("thumbnail",0==o.length?p.find(".item_image img").last().length>0?r.find(".thumbnail_text").val():"":o[0]),b=!1,u(a,!0),$(".entry").each(function(t,e){var a=$(e),i=a.find(".thumbnail_text").val(),r=a.find(".content_files").children(),o=a.attr("data-type"),s=[o];if("image"==o){var d=a.find(".thumbnail_file"),l=d[0].files,p=0==l.length?a.find(".item_image img").length>0?i:"":l[0];c.append("thumbnail_"+t,p)}else if("carousel"==o){var u=[];a.find(".item_caption").each(function(){u.push($(this).val())}),c.append("carousel_captions_"+t,JSON.stringify(u)),r.each(function(e){c.append("carousel_"+t+"_"+e,"text"==$(this).prop("type")?$(this).val():$(this)[0].files[0])})}else"embed"==o&&(u=[],a.find(".item_dattr, .item_dval").each(function(){u.push({name:$(this).attr("name"),value:$(this).val()})}),c.append("embed_"+t,JSON.stringify(u)));a.find(".item_key, .item_change").each(function(t){s.push($(this).val()),2==t&&("image"==o?0==d[0].files.length&&(s[2]=i):"carousel"==o&&(s[2]=r.length))}),s.push(a.attr("data-id")),n.push(s)}),"on"==paper_ep.settings.nodejs&&c.append("socket_id",SOCKET.id),c.append("entries",JSON.stringify(n)),n=g($(".content_rbody")),c.append("recobo",JSON.stringify(n)),n=g($(".content-cpost")),c.append("collaborators",JSON.stringify(n)),c.append("post_sources",JSON.stringify(v(0))),c.append("thumb_sources",JSON.stringify(v(1))),c.append("post_id",paper_ep.post_id),c.append("title",$("#title").val()),c.append("category",$("#category").val()),c.append("type",$("#type").val()),c.append("description",$("#description").val()),c.append("tags",$("#tags").val()),c.append("action",e.attr("data-action")),d.attr("contenteditable",!1),f(u(l,!0),p.find(".text-error")),u(e,!0).addClass("spinner-is-loading"),$.ajax({url:paper_ep.url.edit_post+"?token="+paper_ep.token,type:"POST",data:c,contentType:!1,processData:!1,success:function(t){console.log(t),200==t.S?window.location=t.LK:(u(l,!1),d.attr("contenteditable",!0),$.isArray(t.E)?$.each(t.E,function(t,n){var a=isNaN(n.EL),r=a?$(n.EL):$($(".entry")[n.EL]),o=a?r.parents(".content-field"):r.find(".content-field"),s=(isNaN(n.CT)?o:$(i[n.CT]).parent()).find(".text-error"),d=$(i[n.CT]).children();h(a?0!=n.SW&&r:o.find(n.CS),s,n.TX,e,!1),".post_sources"==n.EL&&n.PS&&d.each(function(t,e){-1!=n.PS.indexOf(t)&&$(d[t]).find("input:nth-child("+n.FD+")").addClass("border-red")})}):s(t.E,!0),m(e),u(a,!1),b=!0)}})}),function(){var t=$("#search-posts"),e=$("#btn-psearch"),n=$("#content-sposts"),a=$("#btn-addrb");$("#btn-dnotify").click(s),a.click(function(){t.focus()}),t.keyup(function(){var a=t.val();a.length>0?u(e,!1):u(e,!0),$.post(paper_ep.url.ecp_search+"?token="+paper_ep.token,{keyword:a,post_id:paper_ep.post_id,post_ids:JSON.stringify(p)},function(t){200==t.S?n.html(t.HT):n.html(t.HT?t.HT:"")})}),$(document).on("click",".btn_putrbody",function(){var t=$(this),e=$(".simditor"),n=e.siblings(".text-error"),i=[];if(0==e.length)return!1;f(e,n),u(t,!0).addClass("spinner-is-loading"),$(".text_simditor").each(function(t,e){i.push($(e).val())}),$.post(paper_ep.url.push_post+"?token="+paper_ep.token,{push_id:t.attr("data-id"),entry_text:JSON.stringify(i),post_id:paper_ep.post_id,post_ids:JSON.stringify(p)},function(i){200==i.S?(a.before(i.HT).addClass("hidden"),p.push(i.ID),t.remove(),m(t)):null==i.PS?(s(i.E,!0),m(u(t,!1))):(e=$(e[i.PS]),$("html").animate({scrollTop:e.parents(".entry").position().top},750),n=e.siblings(".text-error"),s(paper_ep.word.oops_error_has_occurred,!0),h(e,n,i.E,u(t,!1)))})}).on("click",".btn_drecomm",function(){var t=$(this).parents(".content_rbody");p.splice(p.indexOf(parseInt(t.attr("data-id"))),1),t.remove(),0==p.length&&a.removeClass("hidden")})}(),function(){var t=function(t,e){e.length>0?u(t,!1):u(t,!0)},e=function(t,e){clearTimeout(i),f(e),f(t.find(".item_dattr")),t.find(".item_attrna").removeClass("color-red")},n=function(t){t.siblings(".item_embed").html("")},a=function(t){var a=$(this===window?t:this),o=a.parents(".content_get"),s=o.find(".content_edattrs"),d=o.find(".item_attr"),l=o.find(".item_val"),p=l.val(),c=d.val(),u=!0,m="",v="";if(!b)return!1;c.length>0&&(m='<span class="item_attrna color-purple">'+c+"</span>",v='<li class="content_edinput display-flex text-center margin-t15"><div class="content_eainputs display-flex w-100 position-relative"><input class="item_dattr item-input item_key no_validate h-36 background-white color-purple w-100 margin-r15 padding-t5 padding-b5 padding-l10 padding-r10 border-all border-grely border-rlow border-focus-blue sizing-box" type="text" name="attribute" readonly value="'+c+'"></div><button class="btn_ifdel btn-noway h-30 background-red color-wwhite margin-auto padding-t5 padding-b5 padding-l10 padding-r10 border-rlow boxshadow-grey hover-button animate-tab-button animation-ease3s" type="button"><svg class="icon-y vertical-sub" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path fill="currentColor" d="M0 12a1.5 1.5 0 0 1 1.5 -1.5h21a1.5 1.5 0 1 1 0 3H1.5a1.5 1.5 0 0 1 -1.5 -1.5z"></path></svg></button></li>'),p.length>0&&(m='<span class="item_attrna color-purple">'+c+'</span><span class="color-greenly">="</span><span class="item_attrva color-green">'+p+'</span><span class="color-greenly">"</span>',v='<li class="content_edinput display-flex text-center margin-t15"><div class="content_eainputs display-flex w-100 position-relative"><input class="item_dattr item-input item_key no_validate h-36 background-white color-purple w-100 margin-r15 padding-t5 padding-b5 padding-l10 padding-r10 border-all border-grely border-rlow border-focus-blue sizing-box" type="text" name="attribute" readonly value="'+c+'"><input class="item_dval item-input item_key no_validate h-36 background-white color-green w-100 margin-r15 padding-t5 padding-b5 padding-l10 padding-r10 border-all border-grely border-rlow border-focus-blue sizing-box" type="text" name="value" readonly value="'+p+'"></div><button class="btn_ifdel btn-noway h-30 background-red color-wwhite margin-auto padding-t5 padding-b5 padding-l10 padding-r10 border-rlow boxshadow-grey hover-button animate-tab-button animation-ease3s" type="button"><svg class="icon-y vertical-sub" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path fill="currentColor" d="M0 12a1.5 1.5 0 0 1 1.5 -1.5h21a1.5 1.5 0 1 1 0 3H1.5a1.5 1.5 0 0 1 -1.5 -1.5z"></path></svg></button></li>'),e(o,d),s.children().each(function(t){var e=$(this),n=o.find(".item_attrs[data-pos="+t+"] .item_attrna"),a=e.find(".item_dattr");if(c===a.val())return h(a),n.addClass("color-red"),i=setTimeout(function(){f(a),n.removeClass("color-red")},3e3),u=!1,!1}),u?m.length>0&&(n(o),o.find(".before").before('<span class="item_attrs margin-l5" data-pos="'+r+'">'+m+"</span>"),r++,o.find(".item_vattr").text(paper_ep.word.attribute).siblings(".item_vval").text(paper_ep.word.value),d.val("").removeClass("active").focus(),l.val("").removeClass("active"),s.append(v).removeClass("hidden")):h(d)},i=0,r=0;$(document).on("keyup, input",".item_url",function(){var e=$(this),a=e.val(),i=e.parents(".content_get");n(i),i.find(".item_srcva").text(a),t(i.find(".btn_giframe"),a)}).on("keyup, input",".item_attr, .item_val",function(){var n=$(this),a=n.parents(".content_get"),i=a.find(".item_vattr"),r=a.find(".btn_ifadd"),o=n.val(),s=paper_ep.word.attribute,d=paper_ep.word.value,l=o.length>0?o:s;if(n.hasClass("item_val")){if(i=a.find(".item_vval"),0==o.length&&(l=d),o.match(/["]+/))return n.val(""),i.text(d),!1}else{if(o.match(/[^A-Za-z0-9\-\_]+/))return n.val(""),u(r,!0),i.text(s),!1;t(r,o),e(a,n)}i.text(l)}).on("keydown",".item_attr, .item_val",function(t){13==(t.which||t.keyCode)&&a(this)}).on("click",".btn_ifadd",a).on("click",".btn_ifdel",function(){var t=$(this),e=t.parents(".content_get"),a=t.parents(".content_edinput"),i=e.find(".content_edinput");if(!b)return!1;n(e),i.length<=1&&i.parents(".content_edattrs").addClass("hidden"),e.find(".item_attrs[data-pos="+e.find(".content_edinput").index(a)+"]").remove(),a.remove(),r=0,e.find(".item_attrs[data-pos]").each(function(t){$(this).attr("data-pos",t),r++})})}(),$(document).on("click",".btn_esource",function(){var t=$(this),e=t.children(),n=$(e[2]);b&&(t.prev().toggleClass("hidden"),$(e[0]).toggleClass("hidden"),$(e[1]).toggleClass("hidden"),n.toggleClass("rotate-180"))}).on("click",".btn_idelete",function(){var t=$(this).parents(".content-thumbnail"),e=t.find(".content-alert-popup input"),n=t.find(".item-file");b&&(u(n,!1).val(""),t.find(".content-placeholder").removeClass("hidden"),t.find(".content-image").addClass("hidden"),t.find(".item_image img").remove(),""!=n.val()&&u(e,!1),e.val(""),u(t.find(".btn_popup"),!1),g())}).on("click",".btn_repos",function(){if(!b)return!1;var t=$(this).attr("data-type"),e=$(this).parents(".entry"),n=e.length>0?e:$(this).parents(".content_rbody");"up"==t?n.insertBefore(n.prev()):n.insertAfter(n.next())}).on("click",".btn_gvideo",function(){var t=$(this),e=t.parents(".entry"),n=e.find(".content_get"),a=n.find("input"),i=e.find(".text-error");b&&(f(u(a,!0),i),u(t,!0).addClass("spinner-is-loading"),$.post(paper_ep.url.get_frame+"?token="+paper_ep.token,{url:a.val(),type:e.attr("data-type")},function(r){200==r.S?(o(e,n,r.HT),m(t)):h(u(a,!1),i,r.E,t)}))}).on("click",".btn_giframe",function(){var t=$(this),e="iframe"==t.attr("data-type"),n=t.parents(".entry"),a=n.find(".content_get"),i=a.find(".item_url"),r=function(t,n){var i=[];return e?{url:t,type:n}:(a.find(".item_dattr, .item_dval").each(function(){i.push({name:$(this).attr("name"),value:$(this).val()})}),{url:t,type:n,attrs:JSON.stringify(i)})},s=n.find(".text-error");b&&(f(u(i,!0),s),u(t,!0).addClass("spinner-is-loading"),$.post(paper_ep.url.get_frame+"?token="+paper_ep.token,r(i.val(),n.attr("data-type")),function(r){200==r.S?(e?(r.TT&&n.find(".item_title input").addClass("active").val(r.TT),o(n,a,r.HT),1==r.FB&&setTimeout(function(){FB.XFBML.parse()},1e3)):(a.siblings(".item_embed").removeClass("hidden").html(r.HT),u(i,!1)),m(t)):h(u(i,!1),s,r.E,t)}))}),i.click(function(){var t=$(this),e=t.siblings(".text-error");b&&(f(!1,e,t),u(t,!0).addClass("spinner-is-loading"),$.post(paper_ep.url.entry+"?token="+paper_ep.token,{type:i.index(t)},function(n){200==n.S?(m(t),$("#entries").append(n.HT).find(".item_key:not(.no_focus)").focus(),"text"==n.TP&&r(!0),"video"==n.TP&&$("#type").val("video"),u($("#btn-post"),!0)):h(!1,e,n.E,t)}))}),r()}()})(paper_ep);