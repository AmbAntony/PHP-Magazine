// +------------------------------------------------------------------------+
// | @author Oscar Garcés (SoyVillareal)
// | @author_url 1: https://soyvillareal.com
// | @author_url 2: https://github.com/soyvillareal
// | @author_email: hi@soyvillareal.com   
// +------------------------------------------------------------------------+
// | PHP Magazine - The best digital magazine for newspapers or bloggers
// | Licensed under the MIT License. Copyright (c) 2022 PHP Magazine.
// +------------------------------------------------------------------------+
(function(){var r=$("#supported-symbols"),e=$("#btn-change"),a=$("#text-validate"),s=$("#password").focus(),o=$("#re-password"),t=o.siblings(".text-error"),d=function(r){e.attr("disabled",r)},n=function(r){r.addClass("border-red boxshadow-red")},i=function(r){r.removeClass("border-red boxshadow-red")};$("#show-symbols").click(function(){var e=$(this),a=JSON.parse(e.attr("aria-expanded"));a?r.removeAttr("style"):r.css("height",r.children().first().height()),e.attr("aria-expanded",!a)}),e.click(function(){e.addClass("spinner-is-loading"),d(!0),$.post(paper_ar.url.reset_password+"?token="+paper_ar.token,{password:s.val(),re_password:o.val(),tokenu:paper_ar.tokenu},function(r){200==r.S?window.location.href=paper_ar.url.r_login:(t.text(r.E),n(s),n(o),e.removeClass("spinner-is-loading"),d(!1))})}),$(".item_input").on("keyup, input",function(){var r=$(this),e=r.prop("id"),p=o.val(),l=r.val(),c=$("#valid-password").children(),_=function(){$(c.splice(0,2)).addClass("border-orange"),a.text(paper_ar.word.password_security_half)},w=function(r,e){r?e.removeClass("color-grey").addClass("color-green"):e.removeClass("color-green").addClass("color-grey")},h=function(){c.removeClass("border-red border-orange border-green")},u=l.length>=8;"password"==e?(t.text(""),d(!0),i(o.val("").removeClass("active")),h(),l.match(/^(?=.{12,})(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*[¡!\"#$%&'()*+,-./:;<=>¿?@\]\[^_`{|}~]).*$/)?(c.addClass("border-green"),a.text(paper_ar.word.password_security_strong)):l.match(/^(?=.{8,})(?=.*[a-z])(?=.*[0-9])(?=.*[¡!\"#$%&'()*+,-./:;<=>¿?@\]\[^_`{|}~]).*$/)?($(c.splice(0,3)).addClass("border-green"),a.text(paper_ar.word.password_security_good)):l.match(/^(?=.{8,})(?=.*[¡!\"#$%&'()*+,-./:;<=>¿?@\]\[^_`{|}~]).*$/)?_():l.match(/^(?=.{7,})(((?=.*[A-Z])(?=.*[a-z]))|((?=.*[A-Z])(?=.*[0-9]))|((?=.*[a-z])(?=.*[0-9]))).*$/)?_():($(c[0]).addClass("border-red"),a.text(paper_ar.word.password_security_weak)),w(u,$("#icon-five")),w(l.match(/[¡!"#$%&'()*+,-./:;<=>¿?@[\]^_`{|}~]/),$("#icon-supported")),0==l.length&&(h(),a.text(paper_ar.word.write_a_password))):"re-password"==e&&(i(s),p.length>0&&s.val()!=p?(t.text("*"+paper_ar.word.passwords_not_match),n(o),d(!0)):(t.text(""),i(o),p.length>0?d(!1):d(!0))),l.length>0?r.addClass("active"):r.removeClass("active")})})(paper_ar);