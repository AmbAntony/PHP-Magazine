// +------------------------------------------------------------------------+
// | @author Oscar Garc√©s (SoyVillareal)
// | @author_url 1: https://soyvillareal.com
// | @author_url 2: https://github.com/soyvillareal
// | @author_email: hi@soyvillareal.com   
// +------------------------------------------------------------------------+
// | PHP Magazine - The best digital magazine for newspapers or bloggers
// | Licensed under the MIT License. Copyright (c) 2022 PHP Magazine.
// +------------------------------------------------------------------------+
!function(e){e.createCarousel=function(t){var n=[],r=[],a=function(t,n){var r=t.find(".item_caption");t.find(".entry_cimage").css("opacity",0).attr("src",e(t.find(".btn_crepos")[n]).attr("data-image")).animate({opacity:1},300),r.addClass("hidden"),e(r[n]).removeClass("hidden"),o(t)},i=function(t,n){a(t,n),t.find(".btn_crepos.selected").removeClass("selected"),e(t.find(".btn_crepos")[n]).addClass("selected")},c=function(e,n){clearInterval(r[n]),e.blur().attr("data-type","play").find("svg").html("<title>"+t.word.play+'</title><path fill="currentColor" fill-rule="evenodd" d="M18 12.001c0 0.359 -0.366 0.617 -0.366 0.617l-10.273 6.364C6.612 19.472 6 19.109 6 18.179V5.822c0 -0.932 0.612 -1.294 1.362 -0.804l10.273 6.366c-0.001 0 0.365 0.258 0.365 0.617z"/>')},s=function(t){var r=e(".content-carrusel").index(t);return{h:n[r],g:r}},d=function(e){return e.find(".content_files").children()},o=function(e){e.find("div[role=group]").attr("aria-label","1 "+t.word.of+" "+e.find("div[role=progressbar]").attr("aria-valuemax")),e.find("div[role=progressbar]").attr("aria-valuenow",1)},l=function(){n=[],e(".content-carrusel").each(function(t){n.push(0),c(e(this).find(".btn_cauto"),t),i(e(this),0)}),r=[]};e(".entry-carousel").map(e=>n.push(0)),e(document).on("change",".carousel_file",function(){var t=e(this).parents(".content-thumbnail").prev(),r=s(t),a=d(t).length+1;a>1&&t.find(".content-ecbuttons").removeClass("hidden"),n[r.g]=0,t.find("div[role=progressbar]").attr("aria-valuemax",a),o(t)}).on("click",".btn_repos",l).on("click",".btn_adelete",l).on("click",".btn_cchange",function(){var t=e(this).blur(),r=t.parents(".content-carrusel"),o=t.attr("data-type"),l=d(r).length-1,u=s(r),f=u.h;"back"==o&&f>0?f--:"next"==o&&f<l&&f++,r.find(".btn_crepos").index(r.find(".btn_crepos.selected"))!=f&&(c(r.find(".btn_cauto"),u.g),a(r,f),i(r,f)),n[u.g]=f}).on("click",".btn_cauto",function(){var o=e(this),l=o.parents(".content-carrusel"),u=d(l),f=s(l),p=f.h;"play"==o.attr("data-type")?(o.blur().attr("data-type","pause").find("svg").html("<title>"+t.word.pause+'</title><path fill="currentColor" fill-rule="evenodd" d="M18 3.6h-2.4c-0.664 0 -1.2 0.058 -1.2 0.72v15.36c0 0.662 0.536 0.72 1.2 0.72h2.4c0.664 0 1.2 -0.058 1.2 -0.72V4.32c0 -0.662 -0.536 -0.72 -1.2 -0.72zM8.4 3.6H6c-0.664 0 -1.2 0.058 -1.2 0.72v15.36c0 0.662 0.536 0.72 1.2 0.72h2.4c0.664 0 1.2 -0.058 1.2 -0.72V4.32c0 -0.662 -0.536 -0.72 -1.2 -0.72z"/>'),r[f.g]=setInterval(function(){p<u.length-1?p++:(p=0,c(o,f.g)),a(l,p),i(l,p),n[f.g]=p},3e3)):c(o,f.g)}).on("click",".btn_crepos",function(){var t=e(this),r=t.parents(".content-carrusel"),c=r.find(".btn_crepos").index(t);a(r,c),i(r,c),n[s(r).g]=c}).on("click",".btn_cidelete",function(){var t=e(this),a=e("#btn-post"),i=t.parents(".content-carrusel"),o=i.find(".btn_crepos.selected"),l=s(i),u=i.find(".item_caption"),f=i.find(".btn_crepos").index(o),p=d(i),h=p.length-1;c(i.find(".btn_cauto"),l.g),o.remove(),e(p[f]).remove(),e(u[f]).remove(),i.find(".entry_cimage").attr("src",i.find(".btn_crepos").first().addClass("selected").attr("data-image")),u.first().removeClass("hidden"),h>0?(1==h&&i.find(".content-ecbuttons").addClass("hidden"),n[l.g]=0):(n.splice(l.g,1),r.splice(l.g,1),i.removeClass("border-red boxshadow-red").addClass("hidden").next().removeClass("hidden").siblings(".text-error").text(""),(a.length>0?a:e(".btn_post")).attr("disabled",!0))}).on("keyup",".entry-source .item-input",function(){var t=e(this),n=t.parents(".entry");t.val().length>0?n.find(".item_csource").removeClass("hidden").text(t.val()).prev().addClass("hidden"):n.find(".item_csexample").removeClass("hidden").next().addClass("hidden")})}}(jQuery);