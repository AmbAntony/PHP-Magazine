// +------------------------------------------------------------------------+
// | @author Oscar Garcés (SoyVillareal)
// | @author_url 1: https://soyvillareal.com
// | @author_url 2: https://github.com/soyvillareal
// | @author_email: hi@soyvillareal.com   
// +------------------------------------------------------------------------+
// | PHP Magazine - The best digital magazine for newspapers or bloggers
// | Licensed under the MIT License. Copyright (c) 2022 PHP Magazine.
// +------------------------------------------------------------------------+
(function(){var r=$("#btn-pchange"),e=$("#text-validate"),s=$("#current-password"),a=$("#password"),o=$("#re-password"),t=o.siblings(".text-error"),d=s.focus().siblings(".text-error"),n=function(e){r.attr("disabled",e)},c=function(r){r.addClass("border-red boxshadow-red")};$("#show-symbols").click(function(){var r=$(this),e=$("#supported-symbols"),s=JSON.parse(r.attr("aria-expanded"));s?e.removeAttr("style"):e.css("height",e.children().first().height()),r.attr("aria-expanded",!s)}),r.click(function(){r.addClass("spinner-is-loading"),n(!0),$.post(paper_sc.url.change_password+"?token="+paper_sc.token,{user_id:paper_sc.user_id,current_password:s.val(),password:a.val(),re_password:o.val()},function(e){console.log(e),200==e.S?window.location.href=e.UR:(1==e.EX?(d.text(e.E),c(s)):(t.text(e.E),c(a),c(o)),r.removeClass("spinner-is-loading"),n(!1))})}),$(".item_input").on("keyup, input",function(){var r=$(this),i=r.prop("id"),p=o.val(),l=r.val(),_=$("#valid-password").children(),w=function(){$(_.splice(0,2)).addClass("border-orange"),e.text(paper_sc.word.password_security_half)},u=function(r,e){r?e.removeClass("color-grey").addClass("color-green"):e.removeClass("color-green").addClass("color-grey")},h=function(){_.removeClass("border-red border-orange").removeClass("border-green")},v=function(r){r.removeClass("border-red boxshadow-red")},g=l.length,m=g>=8;"current-password"==i?(d.text(""),v(s)):"password"==i?(t.text(""),n(!0),v(o.val("").removeClass("active")),h(),l.match(/^(?=.{12,})(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*[¡!\"#$%&'()*+,-./:;<=>¿?@\]\[^_`{|}~]).*$/)?(_.addClass("border-green"),e.text(paper_sc.word.password_security_strong)):l.match(/^(?=.{8,})(?=.*[a-z])(?=.*[0-9])(?=.*[¡!\"#$%&'()*+,-./:;<=>¿?@\]\[^_`{|}~]).*$/)?($(_.splice(0,3)).addClass("border-green"),e.text(paper_sc.word.password_security_good)):l.match(/^(?=.{8,})(?=.*[¡!\"#$%&'()*+,-./:;<=>¿?@\]\[^_`{|}~]).*$/)?w():l.match(/^(?=.{7,})(((?=.*[A-Z])(?=.*[a-z]))|((?=.*[A-Z])(?=.*[0-9]))|((?=.*[a-z])(?=.*[0-9]))).*$/)?w():($(_[0]).addClass("border-red"),e.text(paper_sc.word.password_security_weak)),u(m,$("#icon-five")),u(l.match(/[¡!"#$%&'()*+,-./:;<=>¿?@[\]^_`{|}~]/),$("#icon-supported")),0==l.length&&(h(),e.text(paper_sc.word.write_a_password))):"re-password"==i&&(v(a),p.length>0&&a.val()!=p?(t.text("*"+paper_sc.word.passwords_not_match),c(o),n(!0)):(t.text(""),v(o),p.length>0?n(!1):n(!0))),g>0?r.addClass("active"):r.removeClass("active")})})(paper_sc);