// +------------------------------------------------------------------------+
// | @author Oscar Garc√©s (SoyVillareal)
// | @author_url 1: https://soyvillareal.com
// | @author_url 2: https://github.com/soyvillareal
// | @author_email: hi@soyvillareal.com   
// +------------------------------------------------------------------------+
// | PHP Magazine - The best digital magazine for newspapers or bloggers
// | Licensed under the MIT License. Copyright (c) 2022 PHP Magazine.
// +------------------------------------------------------------------------+
(function(){var e,t,n,o,r,i,a,s,l,d,c,p,u,f,h,_,v,m,g,k,C=function(e,t){e.attr("disabled",t)},b=function(e){C(e.addClass("spinner-is-loading"),!0)},w=function(e){C(e.removeClass("spinner-is-loading"),!1)},x=paper_u.profile_ids,y=!0;e=$("body"),t=$("#alert-ureport"),n=t.find(".text-error"),o=t.find(".item_rtextarea"),r=$("#container-sposts"),i=$("#content-sresults"),a=$("#content-load-sc"),s=$("#item-followers"),l=$("#item-acontent"),d=$("#item-ralert"),c=$("#item-abuttons"),p=$("#btn-poptions"),u=$("#btn-rsend"),f=$("#alert-pblock"),h=$("#alert-rtitle"),_=$(".item_rinput"),v=function(e){e=this==window?e:$(this),e.attr("aria-expanded",!JSON.parse(e.attr("aria-expanded"))).blur()},m=function(){var e=$(window).height()-85,n=$(".item_rinput:checked ~ .content_description"),o=e-(h.height()+c.height());o<l.children().height()-(n.length>0?n.height():0)?(d.css("height",e),t.css("top","calc(50% - "+e/2+"px)"),l.css("height",o)):g()},g=function(){l.removeAttr("style"),d.removeAttr("style"),t.removeAttr("style")},k=function(){t.addClass("hidden"),_.prop("checked",!1),o.val("")},function(){var e=$("#pfilter"),t=function(){y=!1,C(e,!0),a.removeClass("hidden")},n=function(){C(e,!1),a.addClass("hidden")},o=function(){i.removeClass("hidden"),n(),y=!0};x.length>0&&$(document).scroll(function(){y&&$(document).scrollTop()+$(window).height()>=r.height()&&(t(),$.post(paper_u.url.load_posts+"?token="+paper_u.token,{user_id:paper_u.user_id,filter_by:e.val(),profile_ids:JSON.stringify(x)},function(e){200==e.S?(i.append(e.HT),x=e.IDS,n(),y=!0):n()}))}),e.change(function(n){i.addClass("hidden"),t(),$.post(paper_u.url.filter+"?token="+paper_u.token,{user_id:paper_u.user_id,filter_by:e.val()},function(e){console.log(e),200==e.S?(i.html(e.HT),x=e.IDS,o()):o()})})}(),$(document).click(function(e){!$(e.target).is("#container-poptions, #container-poptions *")&&"true"==p.attr("aria-expanded")&&v(p)}),"on"==paper_u.settings.nodejs&&SOCKET.on("setOutfollow",function(e){s.text(e.TX)}),p.click(v),$("#btn-follow").click(function(){var e=$(this),t=function(t){console.log(t),200==t.S?(s.text(t.TX),e.attr("type",t.T).attr("aria-label",t.L),w(e)):w(e)},n={user_id:paper_u.user_id};b(e),"off"==paper_u.settings.nodejs?$.post(paper_u.url.follow+"?token="+paper_u.token,n,t):SOCKET.emit("setInfollow",n,t)}),$("#btn-pbalert").click(function(){f.removeClass("hidden"),e.addClass("overflow-hidden"),v(p)}),$("#btn-pbcancel").click(function(){f.addClass("hidden"),e.removeClass("overflow-hidden")}),$("#btn-pblock, #btn-punlock").click(function(){var e=$(this);b(e),$.post(paper_u.url.block+"?token="+paper_u.token,{profile_id:paper_u.user_id},function(t){200==t.S?window.location.reload():w(e)})}),$("#btn-preport").click(function(){e.addClass("overflow-hidden"),t.removeClass("hidden"),g(),m()}),$("#btn-rcancel").click(function(){k(),g(),t.addClass("hidden"),e.removeClass("overflow-hidden"),C(u,!0),n.text("")}),_.change(function(){$(".item_rinput:checked")&&C(u,!1),n.text(""),o.val("").next().find(".text_count").text(0),m()}),o.on("keyup, input",function(){var e=$(this),t=e.parent(),n=t.find(".text_count"),o=n.parent(),r=e.val(),i=r.length,a=paper_u.settings.max_words_report;i>.8*a?o.addClass("color-red").removeClass("color-green color-orange"):i>.5*a?o.addClass("color-orange").removeClass("color-red color-green"):o.addClass("color-green").removeClass("color-red color-orange"),n.text(i),e.val(r.slice(0,a-1))}),$(window).resize(m),function(){var t=$("#alert-spalert");$("#btn-suclose").click(function(){t.addClass("hidden"),e.removeClass("overflow-hidden")}),u.click(function(){var e=$(this),o=$(".item_rinput:checked"),r=o.parent(),i=r.find(".item_rtextarea"),a=o.val(),s={reported_id:paper_u.user_id,type:a,place:"user"};i&&(s={reported_id:paper_u.user_id,type:a,place:"user",description:i.val()}),n.text(""),C(_,!0),b(e),$.post(paper_u.url.report+"?token="+paper_u.token,s,function(o){200==o.S?(k(),t.removeClass("hidden"),e.removeClass("spinner-is-loading"),C(_,!1)):(n.text(o.E),w(e.removeClass("spinner-is-loading"),!1),C(_,!1),m())})})}()})(paper_u);